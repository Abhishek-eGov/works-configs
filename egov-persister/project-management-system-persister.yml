serviceMaps:
 serviceName: project-management-system
 mappings:
 - version: 1.0
   name: project
   description: Persists project details in eg_pms_project table
   fromTopic: save-project
   isTransaction: true
   queryMaps:
    - query: INSERT INTO eg_pms_project(id,tenant_id,project_number,name,project_type,project_subtype,department,description,reference_id,start_date,end_date,is_task_enabled,parent,additional_details,is_deleted,row_version,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
      basePath: project.*
      jsonMaps:
       - jsonPath: $.project.*.id

       - jsonPath: $.project.*.tenantId

       - jsonPath: $.project.*.projectNumber

       - jsonPath: $.project.*.name

       - jsonPath: $.project.*.projectType

       - jsonPath: $.project.*.projectSubType

       - jsonPath: $.project.*.department

       - jsonPath: $.project.*.description

       - jsonPath: $.project.*.referenceID

       - jsonPath: $.project.*.startDate

       - jsonPath: $.project.*.endDate

       - jsonPath: $.project.*.isTaskEnabled

       - jsonPath: $.project.*.parent

       - jsonPath: $.project.*.additionalDetails
         type: JSON
         dbType: JSONB

       - jsonPath: $.project.*.isDeleted

       - jsonPath: $.project.*.rowVersion

       - jsonPath: $.project.*.auditDetails.createdBy

       - jsonPath: $.project.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.auditDetails.createdTime

       - jsonPath: $.project.*.auditDetails.lastModifiedTime


    - query: INSERT INTO eg_pms_address(id,tenant_id,project_id,door_no,latitude,longitude,location_accuracy,type,address_line1,address_line2,landmark,city,pin_code,building_name,street,locality,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
      basePath: project.*.address
      jsonMaps:
       - jsonPath: $.project.*.address.id

       - jsonPath: $.project.*.address.tenantId

       - jsonPath: $.project.*.id

       - jsonPath: $.project.*.address.doorNo

       - jsonPath: $.project.*.address.latitude

       - jsonPath: $.project.*.address.longitude

       - jsonPath: $.project.*.address.locationAccuracy

       - jsonPath: $.project.*.address.type

       - jsonPath: $.project.*.address.addressLine1

       - jsonPath: $.project.*.address.addressLine2

       - jsonPath: $.project.*.address.landmark

       - jsonPath: $.project.*.address.city

       - jsonPath: $.project.*.address.pincode

       - jsonPath: $.project.*.address.buildingName

       - jsonPath: $.project.*.address.street

       - jsonPath: $.project.*.address.locality

       - jsonPath: $.project.*.address.auditDetails.createdBy

       - jsonPath: $.project.*.address.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.address.auditDetails.createdTime

       - jsonPath: $.project.*.address.auditDetails.lastModifiedTime


    - query: INSERT INTO eg_pms_target(id,project_id,beneficiary_type,total_no,target_no,is_deleted,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?);
      basePath: project.*.targets.*
      jsonMaps:
       - jsonPath: $.project.*.targets.*.id

       - jsonPath: $.project[*][?({id} in @.targets[*].id)].id

       - jsonPath: $.project.*.targets.*.beneficiaryType

       - jsonPath: $.project.*.targets.*.totalNo

       - jsonPath: $.project.*.targets.*.targetNo

       - jsonPath: $.project.*.targets.*.isDeleted

       - jsonPath: $.project.*.targets.*.auditDetails.createdBy

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.targets.*.auditDetails.createdTime

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedTime


    - query: INSERT INTO eg_pms_document(id,project_id,document_type,filestore_id,document_uid,additional_details,status,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?);
      basePath: project.*.documents.*
      jsonMaps:
       - jsonPath: $.project.*.documents.*.id

       - jsonPath: $.project[*][?({id} in @.documents[*].id)].id

       - jsonPath: $.project.*.documents.*.documentType

       - jsonPath: $.project.*.documents.*.fileStore

       - jsonPath: $.project.*.documents.*.documentUid

       - jsonPath: $.project.*.additionalDetails
         type: JSON
         dbType: JSONB

       - jsonPath: $.project.*.documents.*.status

       - jsonPath: $.project.*.documents.*.auditDetails.createdBy

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.documents.*.auditDetails.createdTime

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedTime


 - version: 1.0
   name: project
   description: Updates project details in eg_pms_project table
   fromTopic: update-project
   isTransaction: true
   queryMaps:
    - query: UPDATE eg_pms_project SET name = ?, project_type = ?, project_subtype = ?, department = ?, description = ?, reference_id = ?, start_date = ?, end_date = ?, is_task_enabled = ?, parent = ?, additional_details = ?, is_deleted = ?, row_version = ?, last_modified_by = ?, last_modified_time = ? WHERE id = ?;
      basePath: project.*
      jsonMaps:

       - jsonPath: $.project.*.name

       - jsonPath: $.project.*.projectType

       - jsonPath: $.project.*.projectSubType

       - jsonPath: $.project.*.department

       - jsonPath: $.project.*.description

       - jsonPath: $.project.*.referenceID

       - jsonPath: $.project.*.startDate

       - jsonPath: $.project.*.endDate

       - jsonPath: $.project.*.isTaskEnabled

       - jsonPath: $.project.*.parent

       - jsonPath: $.project.*.additionalDetails
         type: JSON
         dbType: JSONB

       - jsonPath: $.project.*.isDeleted

       - jsonPath: $.project.*.rowVersion

       - jsonPath: $.project.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.auditDetails.lastModifiedTime

       - jsonPath: $.project.*.id


    - query: UPDATE eg_pms_address SET door_no = ?, latitude=?, longitude=?, location_accuracy=?, type=?, address_line1=?, address_line2=?, landmark=?, city=?, pin_code=?, building_name=?, street=?, locality=?, last_modified_by=?, last_modified_time=? WHERE id=?;
      basePath: project.*.address
      jsonMaps:

       - jsonPath: $.project.*.address.doorNo

       - jsonPath: $.project.*.address.latitude

       - jsonPath: $.project.*.address.longitude

       - jsonPath: $.project.*.address.locationAccuracy

       - jsonPath: $.project.*.address.type

       - jsonPath: $.project.*.address.addressLine1

       - jsonPath: $.project.*.address.addressLine2

       - jsonPath: $.project.*.address.landmark

       - jsonPath: $.project.*.address.city

       - jsonPath: $.project.*.address.pincode

       - jsonPath: $.project.*.address.buildingName

       - jsonPath: $.project.*.address.street

       - jsonPath: $.project.*.address.locality

       - jsonPath: $.project.*.address.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.address.auditDetails.lastModifiedTime

       - jsonPath: $.project.*.address.id


    - query: INSERT INTO eg_pms_target(id,project_id,beneficiary_type,total_no,target_no,is_deleted,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?) ON CONFLICT (id) DO UPDATE SET beneficiary_type = ?, total_no =?, target_no=?, is_deleted=?, last_modified_by=?, last_modified_time=?;
      basePath: project.*.targets.*
      jsonMaps:

       - jsonPath: $.project.*.targets.*.id

       - jsonPath: $.project[*][?({id} in @.targets[*].id)].id

       - jsonPath: $.project.*.targets.*.beneficiaryType

       - jsonPath: $.project.*.targets.*.totalNo

       - jsonPath: $.project.*.targets.*.targetNo

       - jsonPath: $.project.*.targets.*.isDeleted

       - jsonPath: $.project.*.targets.*.auditDetails.createdBy

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.targets.*.auditDetails.createdTime

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedTime

       - jsonPath: $.project.*.targets.*.beneficiaryType

       - jsonPath: $.project.*.targets.*.totalNo

       - jsonPath: $.project.*.targets.*.targetNo

       - jsonPath: $.project.*.targets.*.isDeleted

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.targets.*.auditDetails.lastModifiedTime


    - query: INSERT INTO eg_pms_document(id,project_id,document_type,filestore_id,document_uid,additional_details,status,created_by,last_modified_by,created_time,last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?) ON CONFLICT (id) DO UPDATE SET document_type=?, filestore_id=?, document_uid=?, additional_details=?, status=?, last_modified_by=?, last_modified_time=?;
      basePath: project.*.documents.*
      jsonMaps:

       - jsonPath: $.project.*.documents.*.id

       - jsonPath: $.project[*][?({id} in @.documents[*].id)].id

       - jsonPath: $.project.*.documents.*.documentType

       - jsonPath: $.project.*.documents.*.fileStore

       - jsonPath: $.project.*.documents.*.documentUid

       - jsonPath: $.project.*.additionalDetails
         type: JSON
         dbType: JSONB

       - jsonPath: $.project.*.documents.*.status

       - jsonPath: $.project.*.documents.*.auditDetails.createdBy

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.documents.*.auditDetails.createdTime

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedTime

       - jsonPath: $.project.*.documents.*.documentType

       - jsonPath: $.project.*.documents.*.fileStore

       - jsonPath: $.project.*.documents.*.documentUid

       - jsonPath: $.project.*.additionalDetails
         type: JSON
         dbType: JSONB

       - jsonPath: $.project.*.documents.*.status

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedBy

       - jsonPath: $.project.*.documents.*.auditDetails.lastModifiedTime